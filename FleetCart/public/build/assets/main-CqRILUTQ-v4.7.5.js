import{S as h,N as d,P as x,M as f,T as F}from"./swiper-C8ZQRgZ4-v4.7.5.js";import{m as C}from"./blueimp-md5-BAlJWmXR-v4.7.5.js";import{D as P}from"./drift-zoom-KJ3HkKpL-v4.7.5.js";import{G as O}from"./glightbox-JwK2atHW-v4.7.5.js";import{E as A}from"./Errors-C30A2Jtx-v4.7.5.js";import"./ProductRating-B-YFAG_Q-v4.7.5.js";import"./Pagination-DKj6Zlmg-v4.7.5.js";import"./ProductCard-BzXt53Qu-v4.7.5.js";import"./@popperjs-B72wc7VP-v4.7.5.js";import"./ProductMixin-D4Z8_OKx-v4.7.5.js";let s,b,u=[];Alpine.data("ProductShow",({product:m,variant:S,reviewCount:V,avgRating:I})=>({product:m,item:S||m,optionPrices:{},addingToCart:!1,oldMediaLength:null,activeVariationValues:{},variationImagePath:null,showDescriptionContent:!1,showMore:!1,fetchingReviews:!1,reviews:{},reviewCount:V,avgRating:I,addingNewReview:!1,reviewForm:{},currentPage:1,cartItemForm:{product_id:m.id,qty:1,variations:{},options:{}},errors:new A,get productName(){return this.product.name},get isActiveItem(){return this.item.is_active===!0},get productUrl(){let e=`/products/${this.product.slug}`;return this.hasAnyVariant&&(e+=`?variant=${this.item.uid}`),e},get hasAnyMedia(){return this.item.media.length!==0},get productPrice(){return this.hasSpecialPrice?this.item.selling_price.inCurrentCurrency.amount:this.item.price.inCurrentCurrency.amount},get regularPrice(){const e=this.item.price.inCurrentCurrency.amount;return this.hasAnyOption&&!this.hasSpecialPrice&&this.hasAnyOptionPrice?e+this.optionsPrice:e},get hasSpecialPrice(){return this.item.special_price!==null},get hasPercentageSpecialPrice(){return this.item.has_percentage_special_price},get specialPrice(){const e=this.item.selling_price.inCurrentCurrency.amount;return this.hasAnyOption&&this.hasSpecialPrice&&this.hasAnyOptionPrice?e+this.optionsPrice:e},get isInStock(){return this.item.is_in_stock},get isOutOfStock(){return this.item.is_out_of_stock},get doesManageStock(){return this.item.does_manage_stock},get hasAnyVariationImage(){return this.variationImagePath!==null},get inWishlist(){return this.$store.wishlist.inWishlist(this.product.id)},get inCompareList(){return this.$store.compare.inCompareList(this.product.id)},get hasAnyVariant(){return this.product.variant!==null},get hasAnyOption(){return this.product.options.length>0},get hasAnyOptionPrice(){return Object.keys(this.optionPrices).length!==0},get optionsPrice(){return Object.values(this.optionPrices).reduce((e,t)=>e+t,0)},get isAddToCartDisabled(){return this.isActiveItem?this.isOutOfStock:!0},get maxQuantity(){return this.isInStock&&this.doesManageStock?this.item.qty:null},get isQtyIncreaseDisabled(){return this.isOutOfStock||this.maxQuantity!==null&&this.cartItemForm.qty>=this.item.qty||!this.isActiveItem},get isQtyDecreaseDisabled(){return this.isOutOfStock||this.cartItemForm.qty<=1||!this.isActiveItem},get totalReviews(){return this.reviews.total?this.reviews.total:this.reviewCount},get ratingPercent(){return this.avgRating/5*100},get emptyReviews(){return this.totalReviews===0},get totalPage(){return Math.ceil(this.reviews.total/5)},init(){this.$watch("cartItemForm.options",()=>{this.productPriceWithOptionsPrice()}),s=this.initGalleryPreviewSlider(),b=this.initGalleryPreviewLightbox(),this.fetchReviews(),this.setOldMediaLength(),this.initGalleryPreviewZoom(),this.setActiveVariationsValue(),this.setDescriptionContentHeight(),this.initUpSellProductsSlider(),this.initRelatedProductsSlider()},syncWishlist(){this.$store.wishlist.syncWishlist(this.product.id)},syncCompareList(){this.$store.compare.syncCompareList(this.product.id)},setOldMediaLength(){this.hasAnyVariant&&(this.oldMediaLength=this.item.media.length)},initGalleryPreviewSlider(){return new h(".product-gallery-preview",{modules:[f,d,F],slidesPerView:1,allowTouchMove:!1,navigation:{nextEl:".swiper-button-next",prevEl:".swiper-button-prev"},thumbs:{swiper:this.initGalleryThumbnailSlider()}})},initGalleryThumbnailSlider(){return new h(".product-gallery-thumbnail",{modules:[f,d],slidesPerView:4,spaceBetween:10,watchSlidesProgress:!0,touchEventsTarget:"container",navigation:{nextEl:".swiper-button-next",prevEl:".swiper-button-prev"},breakpoints:{450:{slidesPerView:6},576:{slidesPerView:7},992:{slidesPerView:6},1600:{slidesPerView:7}}})},updateGallerySlider(){this.removeAllGallerySlides(),this.product.media.length===0&&!this.hasAnyMedia?this.addGalleryEmptySlide():this.addGallerySlides(),this.addGalleryEventListeners()},addGallerySlides(){const e=[],t=[];[...this.item.media,...this.product.media].forEach(({path:i})=>{e.unshift(this.galleryPreviewSlide(i)),t.unshift(this.galleryThumbnailSlide(i))}),s.addSlide(0,e),s.thumbs.swiper.addSlide(0,t),s.slideTo(0),s.thumbs.swiper.slideTo(0)},addGalleryEmptySlide(){const e=`${FleetCart.baseUrl}/build/assets/image-placeholder.png`;s.addSlide(0,this.galleryPreviewEmptySlide(e)),s.thumbs.swiper.addSlide(0,this.galleryThumbnailEmptySlide(e))},removeAllGallerySlides(){s.removeAllSlides(),s.thumbs.swiper.removeAllSlides()},addGalleryEventListeners(){this.$nextTick(()=>{this.initGalleryPreviewZoom(),b.reload()})},initGalleryPreviewZoom(){if(this.isMobileDevice()){this.initGalleryPreviewMobileZoom();return}this.initGalleryPreviewDesktopZoom()},initGalleryPreviewMobileZoom(){this.destroyGalleryPreviewZoomInstances(),[...document.querySelectorAll(".gallery-preview-item > img")].forEach(e=>{u.push(new P(e,{namespace:"mobile-drift",inlinePane:!0,inlineOffsetY:-50,passive:!0}))})},initGalleryPreviewDesktopZoom(){this.destroyGalleryPreviewZoomInstances(),[...document.querySelectorAll(".gallery-preview-item > img")].forEach(e=>{u.push(new P(e,{inlinePane:!1,hoverBoundingBox:!0,boundingBoxContainer:document.body,paneContainer:document.querySelector(".product-gallery")}))})},destroyGalleryPreviewZoomInstances(){u.length!==0&&u.forEach(e=>{e.destroy()})},initGalleryPreviewLightbox(){return O({zoomable:!0,preload:!1})},triggerGalleryPreviewLightbox(e){window.innerWidth>990&&e.currentTarget.nextElementSibling.click()},galleryPreviewSlide(e){return`
                <div class="swiper-slide">
                    <div class="gallery-preview-slide">
                        <div class="gallery-preview-item" @click="triggerGalleryPreviewLightbox(event)">
                            <img src="${e}" data-zoom="${e}" alt="${this.productName}">
                        </div>

                        <a href="${e}" data-gallery="product-gallery-preview" class="gallery-view-icon glightbox">
                            <i class="las la-search-plus"></i>
                        </a>
                    </div>
                </div>
            `},galleryThumbnailSlide(e){return`
                <div class="swiper-slide">
                    <div class="gallery-thumbnail-slide">
                        <div class="gallery-thumbnail-item">
                            <img src="${e}" alt="${this.productName}">
                        </div>
                    </div>
                </div>
            `},galleryPreviewEmptySlide(e){return`
                <div class="swiper-slide">
                    <div class="gallery-preview-slide">
                        <div class="gallery-preview-item" @click="triggerGalleryPreviewLightbox(event)">
                            <img src="${e}" data-zoom="${e}" alt="${this.productName}" class="image-placeholder">
                        </div>

                        <a href="${e}" data-gallery="product-gallery-preview" class="gallery-view-icon glightbox">
                            <i class="las la-search-plus"></i>
                        </a>
                    </div>
                </div>
            `},galleryThumbnailEmptySlide(e){return`
                <div class="swiper-slide">
                    <div class="gallery-thumbnail-slide">
                        <div class="gallery-thumbnail-item">
                            <img src="${e}" alt="${this.productName}" class="image-placeholder">
                        </div>
                    </div>
                </div>
            `},productPriceWithOptionsPrice(){Object.entries(this.cartItemForm.options).forEach(([t,i])=>{var o,c,p,g;const r=this.product.options.find(({id:a})=>a===Number(t));if(["field","textarea","date","date_time","time"].includes(r.type)){if(!this.cartItemForm.options[r.id]){delete this.optionPrices[r.id];return}const a=r.values[0],l=((c=(o=a.price)==null?void 0:o.inCurrentCurrency)==null?void 0:c.amount)??+a.price/100*this.productPrice;this.optionPrices[t]=l;return}if(["dropdown","radio","radio_custom"].includes(r.type)){const a=r.values.find(({id:n})=>n===Number(i)),l=((g=(p=a.price)==null?void 0:p.inCurrentCurrency)==null?void 0:g.amount)??+a.price/100*this.productPrice;this.optionPrices[t]=l;return}if(["checkbox","checkbox_custom","multiple_select"].includes(r.type)&&i.length!==0){const l=this.product.options.find(({id:n})=>n===Number(t)).values.filter(n=>i.includes(n.id)).reduce((n,v)=>{var y,w;return n+(((w=(y=v.price)==null?void 0:y.inCurrentCurrency)==null?void 0:w.amount)??+v.price/100*this.productPrice)},0);this.optionPrices[t]=l}})},isVariationValueEnabled(e,t,i){if(t===0)return this.doesVariantExist(i);if(t>0&&t<this.product.variations.length-1)return this.doesVariantExist(i);if(t===this.product.variations.length-1){const r=this.cartItemForm.variations,o=Object.values(r).filter(c=>c!==r[e]);return o.push(i),this.doesVariantExist(o.sort().join("."))}},setActiveVariationsValue(){this.hasAnyVariant&&this.item.uids.split(".").forEach(e=>{this.product.variations.some(t=>{const i=t.values.find(r=>r.uid===e);if(i!==void 0)return this.activeVariationValues[t.uid]=i.label,this.cartItemForm.variations[t.uid]=e,!0})})},setActiveVariationValueLabel(e){this.variationImagePath=null;const t=this.product.variations[e],i=t.values.find(r=>r.uid===this.cartItemForm.variations[t.uid]);this.activeVariationValues[t.uid]=i.label},setVariationValueLabel(e,t){const i=this.product.variations[e],r=i.values[t];!this.isMobileDevice()&&i.type==="image"&&(this.variationImagePath=r.image.path),this.activeVariationValues[i.uid]=r.label},isActiveVariationValue(e,t){return this.cartItemForm.variations.hasOwnProperty(e)?this.cartItemForm.variations[e]===t:!1},syncVariationValue(e,t,i,r){this.isActiveVariationValue(e,i)||(this.cartItemForm.variations[e]=i,this.setVariationValueLabel(t,r),this.updateVariantDetails())},doesVariantExist(e){return this.product.variants.some(({uids:t})=>t.includes(e))},setVariant(){const e=Object.values(this.cartItemForm.variations).sort().join("."),t=this.product.variants.find(r=>r.uids===e);if(t!==void 0){this.item={...t},this.reduceToMaxQuantity();return}const i=C(Object.values(this.cartItemForm.variations).sort().join("."));this.item={uid:i,media:[],base_image:[]},this.cartItemForm.qty=1},setVariantSlug(){const e=`${FleetCart.baseUrl}/products/${this.product.slug}?variant=${this.item.uid}`;window.history.replaceState({},"",e)},updateVariantDetails(){this.setOldMediaLength(),this.setVariant(),this.setVariantSlug(),this.updateGallerySlider()},updateSelectTypeOptionValue(e,t){this.cartItemForm.options=Object.assign({},this.cartItemForm.options,{[e]:t.target.value}),this.errors.clear(`options.${e}`)},updateCheckboxTypeOptionValue(e,t){let i=$(t.target).parents(".variant-check").find('input[type="checkbox"]:checked').map((r,o)=>o.value);this.cartItemForm.options=Object.assign({},this.cartItemForm.options,{[e]:i.get()})},customRadioTypeOptionValueIsActive(e,t){return this.cartItemForm.options.hasOwnProperty(e)?this.cartItemForm.options[e]===t:!1},syncCustomRadioTypeOptionValue(e,t){this.customRadioTypeOptionValueIsActive(e,t)?delete this.cartItemForm.options[e]:(this.cartItemForm.options=Object.assign({},this.cartItemForm.options,{[e]:t}),this.errors.clear(`options.${e}`))},customCheckboxTypeOptionValueIsActive(e,t){return this.cartItemForm.options.hasOwnProperty(e)?this.cartItemForm.options[e].includes(t):(this.cartItemForm.options=Object.assign({},this.cartItemForm.options,{[e]:[]}),!1)},syncCustomCheckboxTypeOptionValue(e,t){this.customCheckboxTypeOptionValueIsActive(e,t)?this.cartItemForm.options[e].splice(this.cartItemForm.options[e].indexOf(t),1):(this.cartItemForm.options[e].push(t),this.cartItemForm=Object.assign({},this.cartItemForm,this.cartItemForm.options),this.errors.clear(`options.${e}`))},setDescriptionContentHeight(){this.$nextTick(()=>{this.showMore=this.$refs.descriptionContent.clientHeight>=400})},setInactiveItemData(){this.item={uid:this.item.uid,media:[],base_image:[]}},isMobileDevice(){return window.matchMedia("only screen and (max-width: 992px)").matches},updateQuantity(e){if(isNaN(e)||e<1){this.cartItemForm.qty=1;return}if(this.cartItemForm.qty=e,this.exceedsMaxStock(e)){this.cartItemForm.qty=this.item.qty;return}},exceedsMaxStock(e){return this.doesManageStock&&this.item.qty<e},reduceToMaxQuantity(){this.doesManageStock&&this.cartItemForm.qty>this.item.qty&&(this.cartItemForm.qty=this.item.qty||1)},addToCart(){this.isAddToCartDisabled||(this.addingToCart=!0,axios.post("/cart/items",{...this.cartItemForm,...this.hasAnyVariant&&{variant_id:this.item.id}}).then(e=>{this.$store.cart.updateCart(e.data),this.$store.layout.openSidebarCart()}).catch(({response:e})=>{e.status===422&&this.errors.record(e.data.errors),notify(e.data.message)}).finally(()=>{this.addingToCart=!1}))},toggleDescriptionContent(){this.showDescriptionContent=!this.showDescriptionContent},async fetchReviews(){this.fetchingReviews=!0;try{const e=await axios.get(`/products/${this.product.id}/reviews?page=${this.currentPage}`);this.reviews=e.data}catch(e){notify(e.response.data.message)}finally{this.fetchingReviews=!1}},addNewReview(){this.addingNewReview=!0,axios.post(`/products/${this.product.id}/reviews`,{...this.reviewForm,...window.grecaptcha&&{"g-recaptcha-response":grecaptcha.getResponse()}}).then(e=>{this.reviewForm={},this.reviews.total++,this.reviews.data.unshift(e.data),notify(trans("storefront::product.review_submitted")),this.errors.reset()}).catch(({response:e})=>{if(e.status===422){this.errors.record(e.data.errors);return}notify(e.data.message)}).finally(()=>{this.addingNewReview=!1,window.grecaptcha&&grecaptcha.reset()})},changePage(e){this.currentPage=e,this.fetchReviews()},hideRelatedProductsSkeleton(){document.querySelectorAll(".landscape-products .swiper-slide-skeleton").forEach(t=>t.remove())},initUpSellProductsSlider(){new h(this.$refs.upSellProducts,{modules:[d],slidesPerView:1,navigation:{nextEl:".swiper-button-next",prevEl:".swiper-button-prev"}})},initRelatedProductsSlider(){this.hideRelatedProductsSkeleton(),new h(this.$refs.landscapeProducts,{modules:[d,x],slidesPerView:2,navigation:{nextEl:".swiper-button-next",prevEl:".swiper-button-prev"},pagination:{el:".swiper-pagination",dynamicBullets:!0,clickable:!0},breakpoints:{640:{slidesPerView:3},880:{slidesPerView:4},992:{slidesPerView:3},1100:{slidesPerView:4},1300:{slidesPerView:5},1600:{slidesPerView:6}}})}}));
