import{m as n}from"./alpinejs-Cm4okMZt-v4.7.5.js";import{t as f}from"./wysiwyg-BooSq1nK-v4.7.5.js";import{E as d}from"./Errors-CUe_UZOJ-v4.7.5.js";import{n as p}from"./NProgress-DsQwVzMe-v4.7.5.js";import"./tinymce-DnlhzABf-v4.7.5.js";import"./@popperjs-B72wc7VP-v4.7.5.js";import"./nprogress-CJk90mHZ-v4.7.5.js";window.Alpine=n;let i,a;n.data("postCreate",()=>({formSubmitting:!1,formSubmissionType:null,form:{meta:{},featured_image:{},publish_status:"published",blog_category_id:""},errors:new d,init(){p(),this.fullscreenMode(),i=this.initTinyMce(),a=this.initTagsSelectize()},fullscreenMode(){$(".fullscreen-mode-open").on("click",e=>{e.preventDefault(),document.fullscreenElement?($(".fullscreen-mode-open .fullscreen-two").removeClass("enter-full-screen"),$(".fullscreen-mode-open .fullscreen-one").addClass("exit-full-screen"),document.exitFullscreen().catch(t=>{alert(`Error attempting to disable full-screen mode: ${t.message} (${t.name})`)})):($(".fullscreen-mode-open .fullscreen-one").removeClass("exit-full-screen"),$(".fullscreen-mode-open .fullscreen-two").addClass("enter-full-screen"),document.documentElement.requestFullscreen().catch(t=>{alert(`Error attempting to enable full-screen mode: ${t.message} (${t.name})`)}))})},initTinyMce(){return f({setup:e=>{e.on("change",()=>{e.save(),e.getElement().dispatchEvent(new Event("input")),this.errors.clear("description")})}})},initTagsSelectize(){return $(".selectize").selectize({plugins:["remove_button"],delimiter:",",persist:!1,onChange:e=>{this.form.tags=e}})},focusDescriptionField(){i.get("description").focus()},addFeaturedImage(){new MediaPicker({type:"image"}).on("select",({id:t,path:s})=>{this.form.featured_image={id:+t,path:s}})},removeFeaturedImage(){this.form.featured_image={}},focusFirstErrorField(e){const t=Object.keys(this.errors.errors),s=[...e].find(o=>t.includes(o.name));if(s.classList.contains("wysiwyg")){i.get(s.getAttribute("name")).focus();return}s.focus()},resetForm(){this.errors.reset(),this.form={meta:{},featured_image:{},publish_status:"published",blog_category_id:""},i.get("description").setContent(""),i.get("description").execCommand("mceCancel"),a[0].selectize.clear()},handleSubmit({submissionType:e}){this.formSubmitting=!0,this.formSubmissionType=e;const{title:t,description:s,meta:o,featured_image:l,publish_status:m,blog_category_id:c,tags:u}=this.form;axios.post("/blog/posts",{title:t,description:s,meta:o,publish_status:m,blog_category_id:c,tags:u,files:{featured_image:l.id?[l.id]:[]}},{params:{...(e==="save_and_edit"||e==="save_and_exit")&&{exit_flash:!0}}}).then(({data:r})=>{if(this.formSubmissionType==="save_and_edit"){location.href=`/admin/blog/posts/${r.blog_post_id}/edit`;return}if(this.formSubmissionType==="save_and_exit"){location.href="/admin/blog/posts";return}success(r.message),this.resetForm(),this.$refs.form.elements[0].focus()}).catch(({response:r})=>{this.errors.record(r.data.errors),this.focusFirstErrorField(this.$refs.form.elements),error(r.data.message)}).finally(()=>{this.formSubmitting=!1,this.formSubmissionType=null})}}));n.start();
