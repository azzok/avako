import{m as c}from"./blueimp-md5-BAlJWmXR-v4.7.5.js";import{t as u}from"./wysiwyg-BooSq1nK-v4.7.5.js";import{C as h}from"./vue-flatpickr-component-BcAP5zaJ-v4.7.5.js";import{C as d}from"./@melloware-hpeTXfkd-v4.7.5.js";import{n as f}from"./NProgress-DsQwVzMe-v4.7.5.js";import{t as p}from"./_plugin-vue_export-helper-Cho5B_tF-v4.7.5.js";import{g as m,a as g}from"./functions-1hbBtiMV-v4.7.5.js";const v={data(){return{isLeftColumnSectionDragging:!1,isRightColumnSectionDragging:!1,sections:{"product-form-left-sections":[],"product-form-right-sections":[]}}},computed:{storeSections(){return{get:t=>this.getSectionsOrder(t.el.dataset.name),set:t=>this.setSectionsOrder(t)}}},created(){this.sections["product-form-left-sections"]=this.getSectionsOrder("product-form-left-sections"),this.sections["product-form-right-sections"]=this.getSectionsOrder("product-form-right-sections")},methods:{getDefaultSectionsOrder(t){return{"product-form-left-sections":["attributes","variations","variants","options","downloads"],"product-form-right-sections":["media","price","inventory","seo","additional"]}[t]},getSectionsOrder(t){const e=JSON.parse(localStorage.getItem(t));return e===null?this.getDefaultSectionsOrder(t):e},setSectionsOrder(t){this.$nextTick(()=>{localStorage.setItem(t.el.dataset.name,JSON.stringify(this.sections[t.el.dataset.name]))})},enableContentSelection(){document.body.classList.remove("disable-content-selection")},disableContentSelection(){document.body.classList.add("disable-content-selection")},notifySectionOrderChange(){toaster(trans("product::products.section.order_saved"),{type:"default"}),this.$nextTick(()=>{this.initAllAttributeValuesSelectize(),this.initColorPicker()})}}},V={watch:{"form.attributes":{deep:!0,immediate:!0,handler(t){t.length===0&&this.addAttribute()}}},methods:{prepareAttributes(t){t.forEach(e=>{e.uid=this.uid()})},getAttributeValuesById(t){if(t==="")return;let e=null;for(const i of Object.values(this.attributeSets))for(const s of i.attributes)if(s.id===t)return e=s.values,e;return e},changeAttribute(t){const e=$(`#attributes-${t.uid}-values`)[0].selectize;e.clear(),e.clearOptions(),t.attribute_id&&(this.getAttributeValuesById(t.attribute_id).forEach(({id:i,value:s})=>{e.addOption({value:i,text:s})}),e.focus())},initAttributeValuesSelectize(t){this.$nextTick(()=>{$(`#attributes-${t}-values`).selectize({plugins:["remove_button"],onChange:e=>{const i=this.form.attributes.find(s=>s.uid===t);i.values=e,this.clearErrors({name:"attributes",uid:t})}})})},addAttribute(){const t=this.uid();this.form.attributes.push({attribute_id:"",uid:t,values:[]}),this.initAttributeValuesSelectize(t)},deleteAttribute(t,e){$(`#attributes-${e}-values`)[0].selectize.destroy(),this.form.attributes.splice(t,1),this.clearErrors({name:"attributes",uid:e})}}},b={data(){return{globalVariationId:"",addingGlobalVariation:!1,variations:[]}},computed:{isAddGlobalVariationDisabled(){return this.globalVariationId===""||this.addingGlobalVariation},isCollapsedVariationsAccordion(){return this.form.variations.every(({is_open:t})=>t===!1)}},watch:{"form.variations":{deep:!0,immediate:!0,handler(t){t.length===0&&this.addVariation({preventFocus:!0})}}},mounted(){this.initColorPicker(),this.hideColorPicker()},methods:{prepareVariations(t){t.forEach(e=>{e.is_open=!1,e.values.forEach(i=>{i.image={id:null,path:null}})})},regenerateVariationsUid(){this.form.variations.forEach(t=>{t.uid=this.uid(),t.values.forEach((e,i)=>{t.values[i].uid=this.uid()})})},reorderVariations(){this.generateVariants(),this.notifyVariantsReordered()},reorderVariationValues(){this.generateVariants(!0)},addVariation({preventFocus:t}){const e=this.uid();this.form.variations.push({uid:e,type:"",is_global:!1,is_open:!0,values:[{uid:this.uid(),image:{id:null,path:null}}]}),t||this.focusField({selector:`#variations-${e}-name`})},deleteVariation(t,e){this.form.variations.splice(t,1),this.clearErrors({name:"variations",uid:e}),this.generateVariants()},changeVariationType(t,e,i){const s=this.form.variations[e];t!==""&&s.values.length===1&&this.focusField({selector:`#variations-${i}-values-${s.values[0].uid}-label`}),t==="text"?s.values.forEach(a=>{this.errors.clear([`variations.${i}.values.${a.uid}.color`,`variations.${i}.values.${a.uid}.image`])}):t==="color"?(s.values.forEach(a=>{this.errors.clear(`variations.${i}.values.${a.uid}.image`)}),this.$nextTick(()=>{this.initColorPicker()})):t==="image"?(s.values.forEach((a,r)=>{a.image||(s.values[r].image={id:null,path:null})}),s.values.forEach(a=>{this.errors.clear(`variations.${i}.values.${a.uid}.color`)})):this.clearValuesError(e,i)},chooseVariationImage(t,e,i,s){new MediaPicker({type:"image"}).on("select",({id:r,path:n})=>{this.form.variations[t].values[i].image={id:+r,path:n},this.errors.clear(`variations.${e}.values.${s}.image`)})},addVariationRow(t,e){const i=this.uid();this.form.variations[t].values.push({uid:i,image:{id:null,path:null}}),this.$nextTick(()=>{this.initColorPicker(),$(`#variations-${e}-values-${i}-label`).trigger("focus")})},addVariationRowOnPressEnter(t,e,i){const s=this.form.variations[e],a=s.values;if(t.target.value!==""){if(a.length-1===i){this.addVariationRow(e,s.uid);return}i<a.length-1&&$(`#variations-${s.uid}-values-${a[i+1].uid}-label`).trigger("focus")}},deleteVariationRow(t,e,i,s){const a=this.form.variations[t];a.values.splice(i,1),this.clearValueRowErrors({name:"variations",variationUid:e,valueUid:s}),a.values.length===0&&this.addVariationRow(t,e),this.generateVariants()},updateColorThumbnails(){this.form.variations.forEach(({uid:t,type:e,values:i})=>{if(e!=="color")return;const s=document.querySelectorAll(`.variation-${t} .clr-field`);i.forEach(({color:a},r)=>{s[r].style.color=a||""})})},initColorPicker(){d.init(),d({el:".color-picker",alpha:!1,rtl:FleetCart.rtl,theme:"large",wrap:!0,format:"hex",selectInput:!0,swatches:["#D01C1F","#3AA845","#118257","#0A33AE","#0D46A0","#000000","#5F4C3A","#726E6E","#F6D100","#C0E506","#FF540A","#C5A996","#4B80BE","#A1C3DA","#C8BFC2","#A9A270"]})},hideColorPicker(){$(document).on("click","#clr-swatches button",t=>{$(t.currentTarget).parents("#clr-picker").removeClass("clr-open")})},addGlobalVariation(){this.globalVariationId!==""&&(this.addingGlobalVariation=!0,axios.get(`/variations/${this.globalVariationId}`).then(({data:t})=>{t.uid=this.uid(),t.is_open=!0,t.values.forEach(e=>{e.uid=this.uid(),e.image||(e.image={id:null,path:null})}),this.form.variations.push(t),this.generateVariants(),this.$nextTick(()=>{$(`#variations-${t.uid}-name`).trigger("focus")})}).catch(t=>{toaster(t.response.data.message,{type:"error"})}).finally(()=>{this.globalVariationId="",this.addingGlobalVariation=!1}))}}},E={data(){return{bulkEditVariantsUid:"",bulkEditVariantsField:"",bulkEditVariants:{special_price_start:null,special_price_end:null}}},computed:{hasBulkEditVariantsUid(){return this.bulkEditVariantsUid!==""},hasBulkEditVariantsField(){return this.bulkEditVariantsField!==""}},methods:{changeBulkEditVariantsUid(t){if(this.resetVariantsSelection(),t===""){this.resetBulkEditVariantsField();return}this.selectVariants(t)},selectVariants(t){if(this.resetVariantsSelection(),t!==""){if(t!=="all"){this.selectSpecificVariants(t);return}this.selectAllVariants()}},selectAllVariants(){this.form.variants.forEach(t=>{t.is_selected=!0})},selectSpecificVariants(t){this.form.variants.forEach(e=>{e.uids.includes(t)&&(e.is_selected=!0)})},changeBulkEditVariantsField(t){["sku","price","special_price"].includes(t)&&this.focusField({selector:`#bulk-edit-variants-${t.replace(/_/g,"-")}`}),this.resetBulkEditVariants()},addBulkEditVariantsMedia(){new MediaPicker({type:"image",multiple:!0}).on("select",({id:e,path:i})=>{this.bulkEditVariants.media.push({id:+e,path:i})})},removeBulkEditVariantsMedia(t){this.bulkEditVariants.media.splice(t,1)},bulkEditvariantsDefaultData(){return{is_active:!0,media:[],price:null,special_price:null,special_price_type:"fixed",special_price_start:null,special_price_end:null,manage_stock:0,qty:null,in_stock:1}},resetBulkEditVariantFields(){this.bulkEditVariantsUid="",this.resetVariantsSelection(),this.resetBulkEditVariantsField()},resetBulkEditVariantsField(){this.bulkEditVariantsField="",this.resetBulkEditVariants()},resetBulkEditVariants(){this.bulkEditVariants={...this.bulkEditvariantsDefaultData()}},resetVariantsSelection(){this.form.variants.forEach(t=>{t.is_selected=!1})},clearVariantsSpecialPriceErrors(t){Object.keys(this.errors).forEach(e=>{e.startsWith(`variants.${t}`)&&e.includes("special_price")&&this.errors.clear(e)})},updateVariantsField(t,{key:e,value:i}){t[e]=i,this.errors.clear(`variants.${t.uid}.${e}`)},updateVariantsStatus(t,{key:e,value:i}){t.is_default!==!0&&(t[e]=i,this.errors.clear(`variants.${t.uid}.${e}`))},updateVariantsSpecialPrice(t,{key:e,value:i},{special_price_type:s,special_price_start:a,special_price_end:r}){t[e]=i,t.special_price_type=s,t.special_price_start=a,t.special_price_end=r,this.clearVariantsSpecialPriceErrors(t.uid)},updateVariantsManageStock(t,{key:e,value:i},{qty:s}){t[e]=i,t.qty=s,this.errors.clear([`variants.${t.uid}.${e}`,`variants.${t.uid}.qty`])},callUpdateVariantsMethodByField(t){return{media:this.updateVariantsField,sku:this.updateVariantsField,is_active:this.updateVariantsStatus,price:this.updateVariantsField,special_price:this.updateVariantsSpecialPrice,manage_stock:this.updateVariantsManageStock,in_stock:this.updateVariantsField}[t]},updateVariants(t){this.form.variants.forEach(e=>{e.is_selected&&this.callUpdateVariantsMethodByField(t.key)(e,t,this.bulkEditVariants)})},bulkUpdateVariants(){if(!this.hasBulkEditVariantsUid&&!this.hasBulkEditVariantsField)return;const t={key:this.bulkEditVariantsField,value:this.bulkEditVariants[this.bulkEditVariantsField]};this.updateVariants(t),this.resetBulkEditVariantFields(),toaster(trans("product::products.variants.bulk_variants_updated"),{type:"default"})}}},k={data(){return{defaultVariantUid:"",variantPosition:0,variantsLength:0}},computed:{hasAnyVariant(){return this.form.variants.length!==0},isCollapsedVariantsAccordion(){return this.form.variants.every(({is_open:t})=>t===!1)}},mounted(){this.hasAnyVariant&&this.setVariantsName()},methods:{prepareVariants(t){t.forEach(e=>{e.position=this.variantPosition++,e.is_open=!1,e.is_selected=!1,e.special_price_start=null,e.special_price_end=null})},changeDefaultVariant(t){const e=this.form.variants,i=e.findIndex(s=>s.uid===t);if(e[i].is_active===!0){this.resetDefaultVariant(),this.defaultVariantUid=e[i].uid,e[i].is_default=!0;return}this.defaultVariantUid=this.defaultVariantUid},setDefaultVariant(){const t=this.form.variants,e=t.findIndex(({uid:s})=>s===this.defaultVariantUid);this.resetDefaultVariant();const i=t[e===-1?0:e];this.defaultVariantUid=i.uid,i.is_default=!0,e===-1&&(this.defaultVariantUid=t[0].uid,t[0].is_active=!0)},isActiveVariant(t){return this.form.variants[t].is_active},changeVariantStatus(t){if(this.defaultVariantUid===t){toaster(trans("product::products.variants.disable_default_variant"),{type:"default"});return}this.clearErrors({name:"variants",uid:t})},resetDefaultVariant(){this.form.variants.some(t=>{if(t.is_default===!0)return t.is_default=!1,!0})},getFilteredVariations(){return this.form.variations.map(({type:t,values:e})=>e.map(({uid:i,label:s})=>{if(t!==""&&s)return{uid:i,label:s}}).filter(Boolean)).filter(t=>t.length!==0)},generateNewVariants(t){return t.reduce((e,i)=>e.flatMap(s=>i.map(a=>({uid:s.uid+"."+a.uid,label:s.label+" / "+a.label})))).map(({uid:e,label:i})=>({uids:e.split(".").sort().join("."),name:i}))},setVariantsName(){this.generateNewVariants(this.getFilteredVariations()).forEach((t,e)=>{this.form.variants[e].name=t.name})},isEqualVariants(t,e){return t.map(({uids:i})=>i).toString()===e.map(({uids:i})=>i).toString()},generateVariants(t){this.$nextTick(()=>{this.initColorPicker(),this.updateColorThumbnails()});const e=this.getFilteredVariations();if(e.length===0){this.form.variants=[],this.variantsLength=0;return}const i=this.generateNewVariants(e),s=this.form.variants.map(({uids:a})=>({uids:a}));t===!0&&this.isEqualVariants(i,s)||(t===!0&&this.notifyVariantsReordered(),i.length>this.variantsLength?this.addVariants(i,s):i.length<this.variantsLength?this.removeVariants(i,s):i.length===this.variantsLength&&this.reorderVariants(i,s),this.variantsLength=i.length,this.setDefaultVariant())},addVariants(t,e){if(this.notifyVariantsCreated(t.length),e.length===0){t.forEach(s=>{this.form.variants.push(this.variantDefaultData(s))});return}if(this.hasCommonVariantUids(t,e)){const s=e.map(({uids:a})=>a);t.forEach((a,r)=>{s.includes(a.uids)||this.form.variants.splice(r,0,this.variantDefaultData(a))});return}const i=[];e.forEach(({uids:s})=>{t.forEach((a,r)=>{const n=s.split(".").every(o=>a.uids.split(".").includes(o));if(n&&!i.includes(s)){i.push(s),this.setVariantData(a,r);return}n&&this.form.variants.splice(r,0,this.variantDefaultData(a))})})},removeVariants(t,e){if(this.resetBulkEditVariantFields(),this.notifyVariantsRemoved(e.length-t.length),this.hasCommonVariantUids(t,e)){const s=t.map(({uids:a})=>a);e.forEach(({uids:a})=>{if(!s.includes(a)){const r=this.form.variants.findIndex(n=>n.uids===a);this.clearErrors({name:"variants",uid:this.form.variants[r].uid}),this.form.variants.splice(r,1)}});return}const i=[];t.forEach(({uids:s,name:a})=>{e.forEach(r=>{const n=this.form.variants.findIndex(l=>l.uids===r.uids),o=s.split(".").every(l=>r.uids.split(".").includes(l));if(o&&!i.includes(s)){i.push(s),this.setVariantData({uids:s,name:a},n);return}o&&(this.clearErrors({name:"variants",uid:this.form.variants[n].uid}),this.form.variants.splice(n,1))})})},reorderVariants(t,e){const i=t.map(({uids:s})=>s);if(this.hasCommonVariantUids(t,e)){e.forEach(({uids:s})=>{const a=i.indexOf(s),r=this.form.variants.findIndex(n=>n.uids===s);this.setVariantData({name:t[a].name},r),this.form.variants[r]=this.form.variants.splice(a,1,this.form.variants[r])[0]});return}t.forEach((s,a)=>{this.setVariantData(s,a)})},hasCommonVariantUids(t,e){return e.some(({uids:i})=>t.map(({uids:s})=>s).includes(i))},setVariantData({uids:t,name:e},i){t!==void 0&&(this.form.variants[i].uid=md5(t),this.form.variants[i].uids=t),this.form.variants[i].name=e},variantDefaultData({uids:t,name:e}){return{position:this.variantPosition++,uid:md5(t),uids:t,name:e,media:[],is_active:!0,is_open:!1,is_default:!1,is_selected:!1,special_price_type:"fixed",special_price_start:null,special_price_end:null,manage_stock:0,in_stock:1}},resetVariants(){this.form.variants=[]},addVariantMedia(t){new MediaPicker({type:"image",multiple:!0}).on("select",({id:i,path:s})=>{this.form.variants[t].media.push({id:+i,path:s})})},removeVariantMedia(t,e){this.form.variants[t].media.splice(e,1)},notifyVariantChanges({count:t,status:e}){toaster(trans(`product::products.variants.variants_${e}`,{count:t,suffix:trans(`product::products.variants.${t>1?"variants":"variant"}`)}).toLowerCase(),{type:"default"})},notifyVariantsCreated(t){this.notifyVariantChanges({count:t,status:"created"})},notifyVariantsRemoved(t){this.notifyVariantChanges({count:t,status:"removed"})},notifyVariantsReordered(){toaster(trans("product::products.variants.variants_reordered"),{type:"default"})}}},S={data(){return{globalOptionId:"",addingGlobalOption:!1}},computed:{isAddGlobalOptionDisabled(){return this.globalOptionId===""||this.addingGlobalOption},isCollapsedOptionsAccordion(){return this.form.options.every(({is_open:t})=>t===!1)}},watch:{"form.options":{deep:!0,immediate:!0,handler(t){t.length===0&&this.addOption({preventFocus:!0})}}},methods:{prepareOptions(t){t.forEach(e=>{e.uid=this.uid(),e.is_open=!1,e.values.forEach((i,s)=>{e.values[s].uid=this.uid()})})},addOption({preventFocus:t}){const e=this.form.options,i=this.uid();e.push({uid:i,type:"",is_open:!0,is_global:!1,is_required:!1,values:[{uid:this.uid(),price_type:"fixed"}]}),t||this.focusField({selector:`#options-${i}-name`})},deleteOption(t,e){this.form.options.splice(t,1),this.clearErrors({name:"options",uid:e})},changeOptionType(t,e){let i=this.form.options[t];const s=this.isOptionTypeText(i)?"price":"label";this.clearValuesError({name:"options",uid:e}),i.values.length===1&&this.focusField({selector:`#options-${e}-values-${i.values[0].uid}-${s}`})},isOptionTypeText(t){return["field","textarea","date","date_time","time"].includes(t.type)?(t.values.length>1&&t.values.splice(1),!0):!1},isOptionTypeSelect({type:t}){return!!["dropdown","checkbox","checkbox_custom","radio","radio_custom","multiple_select"].includes(t)},addOptionRow(t,e){const i=this.uid();this.form.options[t].values.push({uid:i,price_type:"fixed"}),this.focusField({selector:`#options-${e}-values-${i}-label`})},addOptionRowOnPressEnter(t,e,i){const s=this.form.options[e],a=s.values;if(t.target.value!==""){if(a.length-1===i){this.addOptionRow(e,s.uid);return}i<a.length-1&&$(`#options-${s.uid}-values-${a[i+1].uid}-label`).trigger("focus")}},deleteOptionRow(t,e,i,s){const a=this.form.options[t];a.values.splice(i,1),this.clearValueRowErrors({name:"options",optionUid:e,valueUid:s}),a.values.length===0&&this.addOptionRow(t,e)},addGlobalOption(){this.globalOptionId!==""&&(this.addingGlobalOption=!0,axios.get(`/options/${this.globalOptionId}`).then(({data:t})=>{t.uid=this.uid(),t.is_open=!0,t.values.forEach(e=>{e.uid=this.uid()}),this.form.options.push(t),this.$nextTick(()=>{$(`#options-${t.uid}-name`).trigger("focus")}),toaster(trans("product::products.options.option_inserted"),{type:"default"})}).catch(t=>{toaster(t.response.data.message,{type:"error"})}).finally(()=>{this.globalOptionId="",this.addingGlobalOption=!1}))}}},y={watch:{"form.downloads":{deep:!0,immediate:!0,handler(t){t.length===0&&this.addDownload()}}},methods:{addDownload(){this.form.downloads.push({id:null,filename:null})},deleteDownload(t){this.form.downloads.splice(t,1)},chooseDownloadableFile(t){new MediaPicker().on("select",({id:i,filename:s})=>{this.form.downloads.splice(t,1,{id:i,filename:s})})}}},C={methods:{transformMedia(t){t.media=t.media.map(e=>e.id)},transformAttributes(t){t.attributes=t.attributes.filter(({attribute_id:e})=>e!=="").reduce((e,{attribute_id:i,uid:s,values:a})=>({...e,[s]:{attribute_id:i,values:a}}),{})},transformDownloads(t){t.downloads=t.downloads.filter(({id:e})=>e!==null).map(({id:e})=>e)},transformVariations(t){const e={text:["id","uid","label"],color:["id","uid","label","color"],image:["id","uid","label","image"]};t.variations=t.variations.filter(({name:i,type:s})=>!!i||s!=="").reduce((i,s)=>(s.type===""?s.values=[]:s.values=s.values.reduce((a,r)=>(r=_.pick(r,e[s.type]),s.type==="image"&&(r.image=r.image.id),{...a,[r.uid]:r}),{}),{...i,[s.uid]:s}),{})},transformVariants(t){t.variants=t.variants.reduce((e,i)=>(i.media=i.media.map(({id:s})=>s),{...e,[i.uid]:i}),{})},transformOptions(t){const e={text:["id","uid","price","price_type"],select:["id","uid","label","price","price_type"]};t.options=t.options.filter(({name:i,type:s})=>!!i||s!=="").reduce((i,s)=>(s.type===""?s.values=[]:s.values=s.values.reduce((a,r)=>{const n=this.isOptionTypeText(s)?"text":"select";return r=_.pick(r,e[n]),{...a,[r.uid]:r}},{}),{...i,[s.uid]:s}),{})},transformData(t){let e=JSON.parse(JSON.stringify(t));return this.hasAnyVariant&&(e=Object.assign({},e,{price:null,special_price:null,special_price_type:"fixed",special_price_start:null,special_price_end:null,sku:null,manage_stock:0,qty:null,in_stock:1})),this.transformMedia(e),this.transformAttributes(e),this.transformDownloads(e),this.transformVariations(e),this.transformVariants(e),this.transformOptions(e),e}}};window.md5=c;window.toaster=p;const T={components:{flatPickr:h},mixins:[v,V,b,E,k,S,y,C],data(){return{textEditor:null}},mounted(){f(),this.fullscreenMode(),this.initCategoriesSelectize(),this.initTagsSelectize(),this.initUpSellProductsSelectize(),this.initCrossSellProductsSelectize(),this.initRelatedProductsSelectize(),this.textEditor=u({setup:t=>{t.on("change",()=>{t.save(),t.getElement().dispatchEvent(new Event("input")),this.errors.clear("description")})}})},methods:{setProductSlug(t){this.form.slug=g(t)},fullscreenMode(){$(".fullscreen-mode-open").on("click",t=>{t.preventDefault(),document.fullscreenElement?($(".fullscreen-mode-open .fullscreen-two").removeClass("enter-full-screen"),$(".fullscreen-mode-open .fullscreen-one").addClass("exit-full-screen"),document.exitFullscreen().catch(e=>{alert(`Error attempting to disable full-screen mode: ${e.message} (${e.name})`)})):($(".fullscreen-mode-open .fullscreen-one").removeClass("exit-full-screen"),$(".fullscreen-mode-open .fullscreen-two").addClass("enter-full-screen"),document.documentElement.requestFullscreen().catch(e=>{alert(`Error attempting to enable full-screen mode: ${e.message} (${e.name})`)}))})},uid(){return m()},focusEditor(){this.textEditor.get("description").focus()},focusField({selector:t,key:e}){e!==void 0&&this.errors.clear(e),this.$nextTick(()=>{$(`${t}`).trigger("focus")})},initCategoriesSelectize(){$(this.$refs.categories).selectize({plugins:["remove_button"],delimiter:",",persist:!0,selectOnTab:!0,hideSelected:!1,allowEmptyOption:!0,onChange:t=>{this.form.categories=t},onItemAdd(t){this.getItem(t)[0].innerHTML=this.getItem(t)[0].innerHTML.replace(/¦––\s/g,"")},onItemRemove(t){const e=[...this.$dropdown_content.children()].find(i=>i.getAttribute("data-value")===t);e&&e.classList.remove("selected")},onInitialize(){$("#categories").next().find("[data-value]").each((t,e)=>{$(e).html($(e).text().slice(0,-1).replace(/¦––\s/g,"")+'<a href="javascript:void(0)" class="remove" tabindex="-1">×</a>')})}})},initTagsSelectize(){$(this.$refs.tags).selectize({plugins:["remove_button"],onChange:t=>{this.form.tags=t}})},initAllAttributeValuesSelectize(){this.form.attributes.forEach((t,e)=>{var s;const i=((s=this.getAttributeValuesById(t.attribute_id))==null?void 0:s.map(a=>({value:a.id,text:a.value})))??[];$(`#attributes-${t.uid}-values`).selectize({plugins:["remove_button"],onChange:a=>{this.form.attributes[e].values=a,this.clearErrors({name:"attributes",uid:t.uid})},items:t.values,options:[...i]})})},removeDatePickerValue(t){this.form[t]=null},removeVariantDatePickerValue(t,e){this.form.variants[t][e]=null},regenerateVariationsAndVariantsUid(){this.regenerateVariationsUid(),this.generateNewVariants(this.getFilteredVariations()).forEach(({uids:e},i)=>{this.form.variants[i].uid=c(e),this.form.variants[i].uids=e})},hasAnyError({name:t,uid:e}){return Object.keys(this.errors.errors).some(i=>i.startsWith(`${t}.${e}`))},clearErrors({name:t,uid:e}){this.clearMatchedErrors(`${t}.${e}`)},clearValuesError({name:t,uid:e}){this.clearMatchedErrors(`${t}.${e}.values`)},clearValueRowErrors({name:t,uid:e,valueUid:i}){this.clearMatchedErrors(`${t}.${e}.values.${i}`)},clearMatchedErrors(t){Object.keys(this.errors.errors).forEach(e=>{e.startsWith(t)&&this.errors.clear(e)})},focusFirstErrorField(t){this.$nextTick(()=>{[...t].find(e=>e.name===Object.keys(this.errors.errors)[0]).focus()})},addMedia(){new MediaPicker({type:"image",multiple:!0}).on("select",({id:e,path:i})=>{this.form.media.push({id:+e,path:i})})},removeMedia(t){this.form.media.splice(t,1)},preventLastSlideDrag(t){return t.related.className.indexOf("disabled")===-1},toggleAccordions({selector:t,state:e,data:i}){const s=new Event("click"),a=document.querySelectorAll(t);if(!e){i.forEach(({is_open:r},n)=>{r&&a[n].dispatchEvent(s)});return}[...a].forEach(r=>{r.dispatchEvent(s)})},toggleAccordion(t,e){const i=$(t.currentTarget),s=i.find('[data-toggle="collapse"]'),a=i.next();e.is_open&&a.css("display","block"),s.attr("data-transition",!0),e.is_open=!e.is_open,a.slideToggle(300,()=>{s.attr("data-transition",!1),a.removeAttr("style")})},setSearchableSelectizeConfig(){this.searchableSelectizeConfig={plugins:["remove_button"],valueField:"id",labelField:"name",searchField:"name",load:function(t,e){const i="/products";if(t.length===0)return e();axios.get(i,{params:{query:t}}).then(s=>{e(s.data)})}}},initUpSellProductsSelectize(){$(this.$refs.upSellProducts).selectize({...this.searchableSelectizeConfig,onChange:t=>{this.form.up_sells=t}})},initCrossSellProductsSelectize(){$(this.$refs.crossSellProducts).selectize({...this.searchableSelectizeConfig,onChange:t=>{this.form.cross_sells=t}})},initRelatedProductsSelectize(){$(this.$refs.relatedProducts).selectize({...this.searchableSelectizeConfig,onChange:t=>{this.form.related_products=t}})}}};export{T as P};
